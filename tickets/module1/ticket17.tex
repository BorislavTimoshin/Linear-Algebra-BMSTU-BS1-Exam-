\section{
    Матрица перехода от базиса к базису, вывод формулы для преобразования координат вектора при переходе к новому базису. Обратный переход. Работа с тремя и более базисами.
}

\subsection{
    Матрица перехода от базиса к базису.
}

\begin{definition}
    \textit{\textbf{Матрицей перехода}} от старого базиса к новому называется матрица, элементами \textit{\textbf{столбцов}} которой являются координаты векторов нового базиса, разложенных по старому базису.
    \label{fig:definition_17_1}
\end{definition}

\subsection{
    Вывод формулы для преобразования координат вектора при переходе к новому базису.
}

Пусть в $n$-мерном линейном пространстве $\mathcal{L}$ заданы два базиса: старый $b = (\vec{b_1}, \ldots, \vec{b_n})$ и новый $c = (\vec{c_1}, \ldots, \vec{c_n})$.

Разложим векторы базиса $c$ по базису $b$:

$$\vec{c_i} = \alpha_{1i}\vec{b_1} + \ldots + \alpha_{ni}\vec{b_n}, \quad i = \overline{1, n}.$$

Запишем эти представления в матричной форме:

$$\vec{c_i} = b \begin{pmatrix} \alpha_{1i} \\ \vdots \\ \alpha_{ni} \end{pmatrix}, \quad  i = \overline{1, n},$$

или

$$c = bT_{b \to c},$$

где

\begin{equation*}
    T_{b \to c} = \left(\begin{array}{ccc}
        \alpha_{11} & \ldots & \alpha_{1n} \\
        \hdotsfor{3} \\
        \alpha_{n1} & \ldots & \alpha_{nn}
    \end{array}\right).
\end{equation*}

\subsection{
    *Полезное дополнение про преобразование координат вектора при переходе от старого базиса к новому.
}

Выберем произвольный вектор $\vec{x} \in \mathcal{L}$ и разложим его в старом базисе $b$:

$$\vec{x} = bx_b, \quad \quad x_b = \begin{pmatrix} x_1 \\ \vdots \\ x_n \end{pmatrix}.$$

Разложение того же вектора в новом базисе $c$ имеет вид:

$$\vec{x} = cx_c, \quad \quad x_c = \begin{pmatrix} x_1' \\ \vdots \\ x_n' \end{pmatrix}.$$

Найдем связь между старыми координатами $x_b$ вектора $\vec{x}$ и его новыми координатами $x_c$. Из соотношений выше следует, что $bx_b = cx_c$. Учитывая, что $c = bT_{b \to c}$, получаем 
$$bx_b = (bT_{b \to c})x_c,$$ или 
$$bx_b = b(T_{b \to c}x_c).$$ 
Последнее равенство можно рассматривать как запись двух разложений одного и того же вектора $\vec{x}$ в базисе $b$. Разложениями соответствуют столбцы координат $x_b$ и $T_{b \to c}x_c$, которые, согласно теореме \ref{thm:theorem_2_3} о единственности разложения вектора по базису, должны быть равны:
$$x_b = T_{b \to c}x_c, \quad \quad \text{или} \quad \quad x_c = T^{-1}_{b \to c}x_b.$$


\newpage


\subsection{
    Обратный переход. Работа с тремя и более базисами.
}

\textbf{Свойства.}

\begin{enumerate}[label={\arabic*°.}]
    \item Матрица перехода невырождена и всегда имеет обратную.
    \begin{proof}~

        Столбцы матрицы перехода - столбцы координат векторов нового \textbf{базиса} в старом. Следовательно, они, как и векторы базиса, линейно независимы. Значит, матрица $T$ невырожденная и имеет обратную матрицу $T^{-1}$.
    \end{proof}
    
    \item Если в $n$-мерном линейном пространстве задан базис $b$, то для любой невырожденной квадратной матрицы $T$ порядка $n$ существует такой базис $c$ в этом линейном пространстве, что $T$ будет матрицей перехода то базиса $b$ к базису $c$.
    \begin{proof}~

        Из невырожденности матрицы $T$ следует, что ее ранг ранг равен $n$, и поэтому ее столбцы, будучи базисными, линейно независимы. Эти столбцы являются столбцами координат векторов системы $c = bT_{b \to c}$. Линейная независимость столбцов матрицы $T$ равносильна линейной независимости системы векторов $c$. Так как система $c$ содержит $n$ векторов, причем линейное пространство $n$-мерно, то согласно теореме $\eqref{thm:theorem_2_1}$, эта система является базисом.
    \end{proof}
    
    \item Если $T_{b \to c}$ - матрица перехода от старого базиса $b$ к новому базису $c$ линейного пространства, то $T^{-1}_{b \to c}$ - матрица перехода от базиса $c$ к базису $b$.
    \begin{proof}~

        Матрица $T_{b \to c}$ невырождена, и поэтому из равенства $c = bT_{b \to c}$ следует, что $cT^{-1}_{b \to c} = b$. Последнее равенство означает, что столбцы матрицы $T^{-1}_{b \to c}$ являются столбцами координат векторов $b$ относительно базиса $c$, т.е. согласно определению $\eqref{fig:definition_17_1}$ $T^{-1}_{b \to c}$ - это матрица перехода от базиса $c$ к базису $b$.
    \end{proof}

    \item Если в линейном пространстве заданы базисы $b, c$ и $d$, причем $T_{b \to c}$ - матрица перехода от базиса $b$ к новому базису $c$, а $U_{c \to d}$ - матрица перехода от базиса $c$ к базису $d$, то произведение этих матриц $T_{b \to c}U_{c \to d}$ - матрица перехода от базиса $b$ к базису $d$.
    \begin{proof}~

        Согласно определению $\eqref{fig:definition_17_1}$ матрицы перехода, имеем равенства
        $$c = bT_{b \to c}, \quad d = cU_{c \to d},$$
        откуда
        $$d = cU_{c \to d} = (b T_{b \to c}) \cdot U_{c \to d} = b(T_{b \to c} \cdot U_{c \to d}),$$
        т.е. $T_{b \to c} \cdot U_{c \to d} = K_{b \to d}$ - матрица перехода от базиса $b$ к базису $d$.
    \end{proof}

    \item Пусть $b_1, b_2, \ldots, b_n$ - это $n$ базисов линейного пространства $\mathcal{V}$ ($n \geq 4$). $T_k$ - матрица перехода от $b_k$ к $b_{k + 1}$, $k = \overline{1, n - 1}$. Тогда матрица перехода от $b_1$ к $b_n$ равна $T_1\cdot T_2 \cdot \ldots \cdot T_{n - 1}$.
    \begin{proof}
        Последовательное применение свойства 4°.
    \end{proof}
\end{enumerate}
